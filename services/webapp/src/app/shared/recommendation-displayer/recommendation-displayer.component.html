<div class="w-100">
  <div class="row">
    <div class="col-12 text-center border-bottom mb-3">
      <p class="text">These are the movies we recommend you to watch!</p>
      <p class="text" *ngIf="isMember && lastTrainedOn">Your recommendations were generated for you last time on: <i>{{lastTrainedOn | date:'medium'}}</i></p>
      <p class="text" *ngIf="isMember && lastTrainedOn === null">There are no recommendations generated for you yet. Come back in 15 minutes!</p>
      <p class="text" *ngIf="isMember && trainingAllowed" class="pointer demo-train" (click)="startTrainingManually()">For demonstration purposes you can click here to start the training without waiting for the scheduled run. The training takes a while, please be patient.</p>
    </div>
  </div>
  <div class="row mb-2" *ngFor="let rec of filteredRecommendations  | paginate: { itemsPerPage: 3, currentPage: p }; let i = index" [@enterAnim]="{ value: '', params: { delay: i * 150 } }">
    <div class="col-md-3 order-md-0 order-1 col-6">
      <div class="movie-poster" [style]="'background-image: url(https://image.tmdb.org/t/p/original/' +rec.posterPath + '); height: '+height+'px' | safe:'style'" ></div>
    </div>
    <div class="col-md-6 order-md-1 order-0 col-12">
      <h3 class="movie-title">{{rec.title}} <span *ngIf="rec.releaseDate">({{rec.releaseDate | date: 'yyyy'}})</span></h3>
      <p class="movie-tagline" *ngIf="rec.tagline">{{rec.tagline}}</p>
      <div class="genre-list my-2 pb-2 border-bottom">
        <ul>
          <li *ngFor="let genre of rec.genres">
            {{genre.name}}
          </li>
        </ul>
      </div>
      <div class="my-2 pb-2 border-bottom">
        <ul>
          <li *ngFor="let castMember of rec.cast.cast">
            <strong>{{castMember.name}}</strong> ({{castMember.character}})
          </li>
        </ul>
      </div>
      <div class="div">
        <p class="text-sm" *ngIf="rec.overview && !rec.displayFullOverview">{{rec.overview.substr(0,150)}} <span *ngIf="rec.overview.length > 150" (click)="rec.displayFullOverview = true" class="pointer more-less">More ...</span></p>
        <p class="text-sm" *ngIf="rec.overview && rec.displayFullOverview">{{rec.overview}} <span (click)="rec.displayFullOverview = false" class="pointer more-less">Less ...</span></p>
      </div>
    </div>
    <div class="col-md-3 order-2 col-6 text-sm">
      <p><fa-icon [icon]="['fas', 'star']" [fixedWidth]="true" class="mr-2 orange" ngbTooltip="Average Vote (Vote Count)"></fa-icon>{{rec.voteAverage / 2}} ({{rec.voteCount}})</p>
      <p><fa-icon [icon]="['fas', 'fire']" [fixedWidth]="true" class="mr-2 orange" ngbTooltip="Popularity (The Movies Database Rating)"></fa-icon>{{rec.popularity | number: '1.2-2'}}</p>
      <p><fa-icon [icon]="['fas', 'wallet']" [fixedWidth]="true" class="mr-2 orange" ngbTooltip="Budget"></fa-icon>${{(rec.budget / 1000000) | number:'1.2-2'}} MM</p>
      <p><fa-icon [icon]="['fas', 'money-bill']" [fixedWidth]="true" class="mr-2 orange" ngbTooltip="Revenue"></fa-icon>${{(rec.revenue / 1000000) | number:'1.2-2'}} MM</p>
      <p>
        <fa-icon [icon]="['fas', 'language']" [fixedWidth]="true" class="mr-2 orange" ngbTooltip="Original Language"></fa-icon>
        <img alt="English" [src]="'https://unpkg.com/language-icons@0.3.0/icons/'+ rec.originalLanguage+ '.svg' | safe:'resourceUrl'" height="20px">
      </p>
      <p>
        <fa-icon [icon]="['fas', 'language']" [fixedWidth]="true" class="mr-2 orange" ngbTooltip="Spoken Languages"></fa-icon>
        <img *ngFor="let lang of rec.spokenLanguages" [alt]="lang.englishName" [ngbTooltip]="lang.englishName" [src]="'https://unpkg.com/language-icons@0.3.0/icons/'+ lang.languageCode+ '.svg' | safe:'resourceUrl'" height="20px" class="mr-1">
      </p>
<!--      <p>{{rec.productionCompanies}}</p>-->
<!--      <p>{{rec.productionCountries}}</p>-->
    </div>
  </div>
  <div class="row">
    <div class="col-12 text-center">
      <pagination-controls (pageChange)="p = $event"></pagination-controls>
    </div>
  </div>
</div>
